
<h2> <%= @giving.name %> </h2>
<!-- <%= image_tag("gift.jpg", :alt => "Giving") %> -->
<%= image_tag @giving.image.url(:medium) %>
<p> <%= @giving.desc %> <br>
<% if !current_user.nil? %>
	<% if current_user.id == @giving.user_id %>
		<%= link_to "Delete", { action: :destroy }, 
		method: :delete, 
		data: { confirm: "Are you sure?" } %> <br>
	<% end %>
<% end %>
</p>
<div class="condition-toast">
Giver wishes this to be re-given in 
<% if @giving.wish == 10 %>
	<b> a month. </b> 
<% elsif @giving.wish == 20 %>
	<b> 3 months. </b> 
<% elsif @giving.wish == 30 %>
	<b> 6 months. </b> 
<% end %>
</div>

Posted by <span class="user_profile"> 
<%= User.find(@giving.user_id).name %>
</span>
</p>

<% if !current_user.nil? %>
	<% if current_user.id == @giving.user_id %>
		<p>
			<% if !@giving.asks.nil? %>
				<% if @giving.asks.count == 1 %>
					<span class="step"><%= @giving.asks.count %></span><i> re-giver asked for this. </i>
				<% elsif @giving.asks.count > 1 %>
					<span class="step"><%= @giving.asks.count %></span><i> re-givers asked for this. </i>
				<% end %>
			<% end %>
		</p>
		<div class="indent">
			<% @giving.asks.each do |ask| %>
				<p><b><%= User.find(ask.user_id).email %> </b><br>
				<%= ask.comment %> <br>
				<% if ask.status == 1 %>
					<span style="color:green"><i>You accepted this request! </i></span>
				<% else %>
					<%= link_to "Accept", edit_ask_path(id: ask.id, giving_id: @giving.id) %></p>
				<% end %>
			<% end %>
		</div>
	<% else %>
		<div class="indent">
			<% if !@already_asked %>
				<%= form_for([@giving, @giving.asks.build]) do |f| %>
					<p> <input type="checkbox" class="agreement"> I agree to re-give this as per Givers wishes! </p>
					<p> <%= f.text_area :comment, cols: 26, placeholder: "Few words to the Giver..." %> </p>
					<%= f.submit "Ask", class: "btn btn-primary" %>
				<% end %>
			<% else %>
				<% if @ask_accepted %>
					<span style="color:green"><i>Your request was accepted on <%= @timestamp.to_s(:short) %>! </i></span>
				<% else %>
					<i>Your request sent on <%= @timestamp.to_s(:short) %> </i>
				<% end %>
			<% end %>
		</div>
	<% end %>
<% else %>
	<div class="indent">
		<%= form_for([@giving, @giving.asks.build]) do |f| %>
			<p> <input type="checkbox"> I agree to re-give this as per Givers wishes! </p>
			<p> <%= f.text_area :comment, cols: 26, placeholder: "Few words to the Giver..." %> </p>
			<%= f.submit "Ask", class: "btn btn-primary" %>
		<% end %>
	</div>
<% end %>

<br>
<%= link_to "Back", givings_path %>
